<html lang="en">
{% load staticfiles %}
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel='stylesheet' type='text/css' href="{% static "Bootstrap/css/bootstrap.css" %}"  />
    <link rel='stylesheet' type='text/css' href="{% static "Bootstrap/css/bootstrap.min.css"%}"/>
    <link rel='stylesheet' type='text/css' href="{% static "css/default.css"%}"/>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script src="{% static "Bootstrap/js/jquery.min.js" %}"></script>
    <script src="{% static "Bootstrap/js/bootstrap.min.js"%}"></script>
    <script src="{% static "js/multi_step_form.js"%}"></script>
    <script src="{% static "js/jsDatePick.min.1.3.js"%}"></script>
    <link rel='stylesheet' type='text/css' href="{% static "css/jsDatePick_ltr.min.css"%}"/>
<nav class="navbar navbar-default navebarshipper " role="navigation">
   <div class="navbar-header navbartemp">
      <button type="button" class="navbar-toggle" data-toggle="collapse" 
         data-target="#menu-collapse">
         <span class="sr-only">Toggle navigation</span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/home/">Freighttrackers</a>
   </div>
   <div class="collapse navbar-collapse navbartemp" id="menu-collapse">
      <ul class="nav navbar-nav navbar-right">
        
         <li><a href="/notification/">Notification</a></li>
         <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <b>{{company}}</b><b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
               <li><a href="#">view</a></li>
               <li><a href="#">edit</a></li>
               <li><a href="#">Transaction</a></li>
               <li><a href="#">Documents</a></li>
               <li ><a href="/logout/">Logout</a></li>
            </ul>
         </li>
         

      </ul>
   </div>
</nav> 

</head>
<body>
  {%if not update  %}
 <div class="alert alert-danger warning col-xs-12" role="alert">
      Please <a href="/updatepickuplocation/">update</a> your company location so we can easily contact you
 </div>
 {%endif%}
    
<div class="col-sm-5">    
<div class="quoteform well1">

    <form action="" method="POST">
      {%csrf_token%}
        <div class="form-group col-sm-12">
              <div class="col-sm-4">
               <select type="text" class="form-control" placeholder="FROM" name="source" id="source" required >
                        <option disabled selected>FROM</option>
                       {% for item in lst1%}
                         <option value="{{item.city}}">{{item.city}}</option>
                       {%endfor%}
                </select>
              </div>
              <div class="col-sm-4">
                <select type="text" class="form-control" placeholder="To" name="destination" id="destination" required >
                        <option disabled selected>TO</option>
                       {% for item in lst1%}
                         <option value="{{item.city}}">{{item.city}}</option>
                       {%endfor%}
                </select>
              </div>
             <div class="col-sm-4">
                <div class="input-group add-on col-sm-3 date datepicker" data-date-format="yyyy-mm-dd">
                       <input name="calendervalue" placeholder="Pick up date" id="calendervalue" value="" class="form-control date-picker" data-date-format="yyyy-mm-dd" type="text">
                    
                     
               </div>
               <div id="calender" class="cal">
                    </div>
             </div>  
        </div>   
        <div class="form-group col-sm-12">
             <div class="col-sm-4">
                <select  class="form-control" name="loadtype" placeholder="Load Type" required value={{loadtype}}>
                  <option disabled selected>Load Type</option>
                 <option >Container</option>
                 <option >Coal And Ash</option>
                 <option >Fruts And vegitable</option>
                 <option >Liquid and oil</option>
                 <option >Chemicles</option>
                 <option >Machinery</option>
                 <option >textiles</option>
                 <option >Vehicles part</option>
                </select> 
              </div>
              <div class="col-sm-4">
                <Select  class="form-control" name="quantity" placeholder="Quantity" required value={{quantity}}>
                <option disabled selected>Quantity(Tones)</option>
                 <option >1-3</option>
                 <option >4-6</option>
                 <option >7-10</option>
                 <option >11-15</option>
                 <option >16-20</option>
                 <option >17-21</option>
                 <option >22-25</option>
                 <option>25-35</option>
                </select> 
              </div>
              
              <div class="col-sm-4">
                <Select  class="form-control" name="numoftruck" required value={{trucknum}}>
                <option disabled selected>Trucks</option>
                 <option >1</option>
                 <option >2</option>
                 <option >3</option>
                 <option >4</option>
                 <option >5</option>
                 <option >6</option>
                 <option >7</option>
                 <option>8</option>
                </select>
              </div>
        </div>       
      
        <button class=" setbtn btn btn-primary col-sm-4" onclick="quote()">Quote</button>
   </form>
 
</div>
<div class="requestdetail col-xs-12 well">
    <table class="table table-striped">
    <thead>
      <tr>
        <th>Load Detail</th>
        <th>Comapny</th>
        <th>Cost</th>
        <th>Rating</th>
      </tr>
    </thead>
    <tbody>
        {% for item in lst%}
      <tr>
        <td><button class=" setbtn1 btn btn-primary" data-toggle="modal" data-target="#loadid{{item.id}}" >Load</button></td>
        <td>{{item.companyname}}</td>
        <td>{{item.cost}}</td>
        {%if item.rating == 1%}
        <td><img src="{%static "img/star1.png"%}"></td>
        {%elif item.rating == 2%}
        <td><img src="{%static "img/star1.png"%}"><img src="{%static "img/star1.png"%}"></td>
        {%elif item.rating == 3%}
        <td><img src="{%static "img/star1.png"%}"><img src="{%static "img/star1.png"%}"><img src="{%static "img/star1.png"%}"></td>
        {%elif item.rating == 4%}
        <td><img src="{%static "img/star1.png"%}"><img src="{%static "img/star1.png"%}"><img src="{%static "img/star1.png"%}"><img src="{%static "img/star1.png"%}"></td>
        {%else%}
        <td><img src="{%static "img/star1.png"%}"><img src="{%static "img/star1.png"%}"><img src="{%static "img/star1.png"%}"><img src="{%static "img/star1.png"%}"><img src="{%static "img/star1.png"%}"></td>
        {%endif%}
        <td><button class="setbtn1 btn btn-success" onclick="requestaccept()">Accept</button></td>
      </tr>
      <div class="modal fade" id="loadid{{item.id}}" role="dialog">
            <div class="modal-dialog">
    
      <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-body">
                        <div>
                            <h1>Load Detail<h1>
                             <ul class="list-group">
                                  <li class="list-group-item list-group-item-info">Source:{{item.source}}</li>
                                  <li class="list-group-item list-group-item-info">Destination:{{item.destination}}</li>
                                  <li class="list-group-item list-group-item-info">PickupDate:{{item.pickupdate}}</li>
                                  <li class="list-group-item list-group-item-info">Load Type:{{item.loadtype}}</li>
                                  <li class="list-group-item list-group-item-info">Quantity:{{item.quantity}}</li>
                                  <li class="list-group-item list-group-item-info">Required truck:{{item.numoftruck}}</li>
                             </ul>
                        </div>            
                    </div>
       
                    <div class="modal-footer">
                         <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
      
            </div>
    </div>    



      {% endfor%}

      
    </tbody>
  </table>

</div> 
</div>  
<div class="col-sm-7">
  <div 
        id="map-canvas1">
    </div>
</div> 
</body>    
</html>
<script>
function requestaccept(){
    alert("We will contact soon")
}
function quote(){
    alert("We will contact soon")
}

  
  // The markers are stored in an array.
  // The user can then click an option to hide, show or delete the markers.
 var map;
var cordinates = [];
var temp = []
{%for item in lst%}
cordinates.push(new google.maps.LatLng({{item.lat}},{{item.lon}}));
temp.push("{{item.companyname}} ")
{%endfor%}
var position = new google.maps.LatLng(parseFloat({{lat}}),parseFloat({{lon}}));
var trip=cordinates;
var markers = [];
function initialize() {
  var mapOptions = {
    zoom: 12,
    center:cordinates[0],
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  map = new google.maps.Map(document.getElementById('map-canvas1'),
      mapOptions);
  //infowindowopen(map,marker);
  //This event listener will call addMarker() when the map is clicked.
  //google.maps.event.addListener(map, 'click', function(event) {
   // addMarker(event.latLng);
  //});
   addcompany();
  for(var i=0;i<trip.length;i++){
    addMarker(trip[i],i);
  }
  // Adds a marker at the center of the map.
  //addMarker(haightAshbury);
}

function addcompany(){
  var iconBase = "{%static "img/C.png"%}";
  var marker = new google.maps.Marker({
    position: position,
    map: map,
    icon: iconBase
  });
  var infowindow = new google.maps.InfoWindow({
    content:"{{company}}"
  });
  infowindow.open(map,marker);
  marker.setMap(map);
}
// Add a marker to the map and push to the array.
function addMarker(location,i) {
  var iconBase = "{%static "img/T.png"%}";
  var marker = new google.maps.Marker({
    position: location,
    map: map,
    icon: iconBase
  });
  var infowindow = new google.maps.InfoWindow({
    content: temp[i]
  });
  infowindow.open(map,marker);
  markers.push(marker);
}
// Sets the map on all markers in the array.
function setAllMap(map) {
  for (var i = 0; i < markers.length; i++) {
    markers[i].setMap(map);
  }
}


google.maps.event.addDomListener(window, 'load', initialize);

function loadcalender(){
    g_globalObject = new JsDatePick({
      useMode:1,
      isStripped:true,
      target:"calender"
    });   
    
    g_globalObject.setOnSelectedDelegate(function(){
      var obj = g_globalObject.getSelectedDay();
      document.getElementById("calendervalue").value = obj.year+"-"+obj.month+"-"+obj.day;
    });

      
    
  };
  $("#calButton").click(function(){
    $("#calender").toggle();
  });
  $.fn.stars = function() {
    return $(this).each(function() {
        // Get the value
        var val = parseFloat($(this).html());
        // Make sure that the value is in 0 - 5 range, multiply to get width
        var size = Math.max(0, (Math.min(5, val))) * 16;
        // Create stars holder
        var $span = $('<span />').width(size);
        // Replace the numerical value with stars
        $(this).html($span);
    });
}
$(function() {
    $('span.stars').stars();
});
</script>
