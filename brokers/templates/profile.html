<html lang="en">
{% load staticfiles %}
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel='stylesheet' type='text/css' href="{% static "Bootstrap/css/bootstrap.css" %}"  />
    <link rel='stylesheet' type='text/css' href="{% static "Bootstrap/css/bootstrap.min.css"%}"/>
    <link rel='stylesheet' type='text/css' href="{% static "css/default.css"%}"/>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script src="{% static "Bootstrap/js/jquery.min.js" %}"></script>
    <script src="{% static "Bootstrap/js/bootstrap.min.js"%}"></script>
    {% include "navbar.html" %}

</head>
<body onload="initialize()">
{%if not update  %}
 <div class="alert alert-danger warning col-xs-12" role="alert">
      Please <a href="/updatelocation/">update</a> your company location so we can easily contact you
 </div>
 {%endif%}
 

  <!-- You can even embed a Google Form here -->
<div class="col-xs-12-well">  
<div class=" col-xs-5 well">


  <div class="list-group ">
    <a class="list-group-item active">
      <h4 class="list-group-item-heading"><b>NEW OFFERS</b></h4>
      
    </a>
    {%for c,s,d,p,l,n,q in loadlist%}
    <table class="table table-hover ">
      <tr >
         <div class="company"><b class="var">{{c}}</b></div>
      </tr>
      <tr>
        <td><b>Source:</b>{{s}}</td>
        <td><b>Destination:</b>{{d}}</td>
        <td><b>Date:</b>{{p}}</td>
        
      </tr>
      <tr>
        <td><b>Type:</b>{{l}}</td>
        <td><b>Truck:</b>{{n}}</td>
        <td><b>Quantity:</b>{{q}}</td>
        
      </tr>
      
  
  </table>
  <button type="button" class="btn btn-success" data-toggle="modal" data-target="#loginModal{{item.id}}" name="deal"{{item.id}} >Request</button>
  <div class="container">
  <div class="modal fade" id="loginModal{{item.id}}" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-body">
            
          <h1 class="text-muted">Cost </h1>
          <hr/>
          <form action="/profile/" method="POST">
            {%csrf_token%}
            <div class="form-group">
            <input type="text" class="form-control i" name="cost" placeholder="Cost" required name="cost" value={{cost}}>
            </div>
            <button type="submit" class="btn btn-success" name="request" value={{item.id}} onclick="message()">Submit</button>
          </form>
    </div>
       
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
</div>
  <br>
  <br>
    {%endfor%}
  </div>


</div>
<div class="col-xs-7  mapspace" id="map-canvas">


</div>


  


</div>
</body>


  <script>

  // In the following example, markers appear when the user clicks on the map.
  // The markers are stored in an array.
var map;
var cordinates = [];
var temp = []
{%for c,lt,ln in location%}
cordinates.push(new google.maps.LatLng({{lt}},{{ln}}));
temp.push("{{c}} ")
{%endfor%}
var position = new google.maps.LatLng(parseFloat({{lat}}),parseFloat({{lon}}));
var trip=cordinates;
var markers = [];
function initialize() {
  var mapOptions = {
    zoom: 12,
    center:cordinates[0],
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  map = new google.maps.Map(document.getElementById('map-canvas'),
      mapOptions);
  //infowindowopen(map,marker);
  //This event listener will call addMarker() when the map is clicked.
  //google.maps.event.addListener(map, 'click', function(event) {
   // addMarker(event.latLng);
  //});
   addbroker();
  for(var i=0;i<trip.length;i++){
    addMarker(trip[i],i);
  }
  // Adds a marker at the center of the map.
  //addMarker(haightAshbury);
}

function addbroker(){
  var iconBase = "{%static "img/a.png"%}";
  var marker = new google.maps.Marker({
    position: position,
    map: map,
    icon: iconBase
  });
  var infowindow = new google.maps.InfoWindow({
    content:"{{company}}"
  });
  infowindow.open(map,marker);
  marker.setMap(map);
}
// Add a marker to the map and push to the array.
function addMarker(location,i) {
  var iconBase = "{%static "img/letter_c.png"%}";
  var marker = new google.maps.Marker({
    position: location,
    map: map,
    icon: iconBase
  });
  var infowindow = new google.maps.InfoWindow({
    content: temp[i]
  });
  infowindow.open(map,marker);
  markers.push(marker);
}
// Sets the map on all markers in the array.
function setAllMap(map) {
  for (var i = 0; i < markers.length; i++) {
    markers[i].setMap(map);
  }
}






function message(){
  alert("We will contact you soon")
}
 
</script>
            
        